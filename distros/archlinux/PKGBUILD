pkgname="shutorial"
pkgver="0.2"
pkgrel="021"
pkgdesc="An exerciser teaching the use of the shell console, in practice."
arch=("any")
url="https://github.com/mquinson/shutorial"
license=("GPL3")
source=($pkgname-$pkgver.tar.xz)
depends=("schroot" "squashfs-tools" "debootstrap")
makedepends=("python>=3.6" "python-markdown" "python-markupsafe" "python-jinja" "sharutils")

build() {
	cd $pkgname-$pkgver
	make all
}

package() {
	cd $pkgname-$pkgver
	make DESTDIR="$pkgdir/" install-arch
}

post_install() {
	echo "Creating the shutorial squashfs"
	/usr/sbin/shutorial-admin ensure-squashfs
	/usr/sbin/shutorial-admin schroot-users
}

pre_remove() {
	if [ -e /usr/lib/shutorial/debian-stable.squashfs ]Â ; then
        echo "Cleaning the shutorial squashfs"
        rm /usr/lib/shutorial/debian-stable.squashfs
	fi
}

